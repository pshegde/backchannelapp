<% if session[:user_id] != nil %>
    <div>
      <% if flash[:alert] %>
          <div  style="font-weight:bold;color: #cc0000;">
            <%= flash[:alert] %>
          </div>
      <% end %>
    <h1>A Brief Listing of Posts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="position:absolute;right: 15px;"> Welcome,
      <% if session[:user_id] %>
          <%=session[:user_id].username%>!
      <%end%>
    </span></h1>
      </div>



<% @posts.each do |post| %>

      <% @commentsForPost = Comment.find_all_by_Post_id(post.id)%>

          <div style="background-color: #00bfff;font-size:15px;">
            <b><%= post.title %>  </b>

            <% if session[:isadmin] ==true or session[:user_id].id ==post.User_id %>
                &nbsp;&nbsp;&nbsp;<td><%= link_to 'Edit', edit_post_path(post) %></td>
                &nbsp;&nbsp;&nbsp;<td><%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %>
            <%end%>
            &nbsp;&nbsp;&nbsp;<a href=<%="/commentsforpost/new?post_id_passed=" + post.id.to_s%>>Comment</a>
            &nbsp;&nbsp;&nbsp;<a href=<%="/voteforpost/incrementVote?post_id_for_vote=" + post.id.to_s%>>Vote</a>
            &nbsp;&nbsp;&nbsp; <%= post.num_votes %>  Votes
          </div>
          <div style="background-color: #bbffbb;">
            <%= post.content %>
          </div>
          <div>
            <b>Category:</b><%= Category.find(post.Category_id).name %>
            &nbsp;&nbsp;&nbsp;<b>Author:</b><%= User.find(post.User_id).username %>
          </div>
        <div style="background-color: #7fffd4;">
           <b>Comments:</b>  <br>
           <% @commentsForPost.each do |comment| %>
              <%=comment.content%>
              &nbsp;&nbsp;&nbsp;Posted by:<%=User.find(comment.User_id).username%>
              <% if session[:isadmin] ==true or session[:user_id].id ==comment.User_id %>
                  &nbsp;&nbsp;&nbsp;<%= link_to 'Edit', edit_comment_path(comment) %>
                  &nbsp;&nbsp;&nbsp;<%= link_to 'Destroy', comment, method: :delete, data: { confirm: 'Are you sure?' } %>
              <%end%>

              &nbsp;&nbsp;&nbsp;<a href=<%="/voteforcomment/incrementVote?comment_id_for_vote=" + comment.id.to_s%>>Vote</a>
              &nbsp;&nbsp;&nbsp;<%= comment.num_votes %>  Votes
            <br>
           <%end%>
          </div>
    <hr/>

<% end %>
<br />



<%= link_to 'Post a Question', :controller => "posts", :action => "new" %>

<%end%>